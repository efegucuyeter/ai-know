<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Profil</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
    <style>
        body {
            background: #578FCA;
            background: radial-gradient(circle, rgba(87, 143, 202, 1) 53%, rgba(148, 187, 233, 1) 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            position: relative;
        }
        .main-content {
            flex: 1;
            padding-bottom: 100px;
        }
        .navbar-custom, footer {
            background-color: #3674B5 !important;
        }
        .page-title {
            color: #2c5d95;
            text-align: center;
            margin: 40px 0;
            font-weight: bold;
        }
        .section-title {
            color: white;
            margin: 30px 0 20px 0;
            font-weight: bold;
            text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.5);
            padding-left: 10px;
            border-left: 5px solid #3674B5;
        }
        .profile-card {
            background: rgba(0, 51, 102, 0.2);
            backdrop-filter: blur(10px);
            border-radius: 10px;
            overflow: hidden;
            padding: 30px;
            color: white;
            margin-bottom: 30px;
        }
        .profile-header {
            display: flex;
            align-items: center;
            margin-bottom: 30px;
        }
        .profile-avatar-container {
            position: relative;
            margin-right: 30px;
        }
        .profile-avatar {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            border: 4px solid #3674B5;
            object-fit: cover;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .profile-avatar:hover {
            opacity: 0.8;
        }
        .avatar-upload-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 120px;
            height: 120px;
            border-radius: 50%;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transition: opacity 0.3s ease;
            cursor: pointer;
            color: white;
            font-size: 1.5rem;
        }
        .profile-avatar-container:hover .avatar-upload-overlay {
            opacity: 1;
        }
        .profile-info h3 {
            font-size: 1.8rem;
            font-weight: bold;
            margin-bottom: 5px;
        }
        .profile-info p {
            font-size: 1rem;
            opacity: 0.8;
            margin-bottom: 5px;
        }
        .profile-stats {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-bottom: 30px;
        }
        .stat-card {
            background-color: rgba(255,255,255,0.1);
            border-radius: 8px;
            padding: 15px;
            flex: 1;
            min-width: 150px;
            text-align: center;
        }
        .stat-card h4 {
            font-size: 2rem;
            margin-bottom: 5px;
            color: white;
        }
        .stat-card p {
            font-size: 0.9rem;
            color: #e0e0e0;
            margin-bottom: 0;
        }
        .profile-details {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
        }
        .details-box {
            flex: 1;
            min-width: 300px;
        }
        .detail-item {
            margin-bottom: 15px;
        }
        .detail-item label {
            display: block;
            font-size: 0.85rem;
            color: #e0e0e0;
            margin-bottom: 5px;
        }
        .detail-item p {
            background-color: rgba(255,255,255,0.1);
            padding: 10px 15px;
            border-radius: 5px;
            margin-bottom: 0;
        }
        .btn-edit {
            background-color: white;
            color: #3674B5;
            font-weight: bold;
            transition: all 0.3s;
            padding: 8px 25px;
            margin-top: 20px;
        }
        .btn-edit:hover {
            background-color: #2c5d95;
            color: white;
        }
        .badge-custom {
            background-color: #3674B5;
            color: white;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.8rem;
            margin-right: 5px;
            margin-bottom: 5px;
            display: inline-block;
        }
        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 30px 0 20px 0;
        }
        .section-header h3 {
            color: white;
            font-weight: bold;
            text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.5);
            padding-left: 10px;
            border-left: 5px solid #3674B5;
            margin: 0;
        }
        .view-all {
            color: #3674B5;
            background-color: white;
            border-radius: 20px;
            padding: 5px 15px;
            font-size: 0.9rem;
            margin-top: 5px;
            text-decoration: none;
            transition: all 0.3s;
        }
        .view-all:hover {
            background-color: #2c5d95;
            color: white;
        }
        .activity-card {
            background: rgba(0, 51, 102, 0.2);
            backdrop-filter: blur(10px);
            border-radius: 10px;
            padding: 20px;
            color: white;
            margin-bottom: 20px;
        }
        .activity-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        .activity-title {
            font-weight: bold;
            font-size: 1.2rem;
        }
        .activity-date {
            font-size: 0.85rem;
            color: #e0e0e0;
        }
        .activity-content {
            display: flex;
            align-items: center;
        }
        .activity-icon {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background-color: rgba(255,255,255,0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 15px;
            font-size: 1.5rem;
        }
        .activity-details {
            flex: 1;
        }
        .activity-details p {
            margin-bottom: 5px;
        }
        .activity-score {
            font-size: 1.2rem;
            font-weight: bold;
        }
        .trophy-item {
            display: flex;
            align-items: center;
            background: rgba(0, 51, 102, 0.2);
            backdrop-filter: blur(10px);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
        }
        .trophy-icon {
            font-size: 2rem;
            color: gold;
            margin-right: 15px;
        }
        .trophy-info {
            flex: 1;
        }
        .trophy-title {
            font-weight: bold;
            margin-bottom: 5px;
        }
        .trophy-desc {
            font-size: 0.9rem;
            color: #e0e0e0;
        }
        .trophy-date {
            font-size: 0.85rem;
            color: #e0e0e0;
            align-self: start;
        }
        footer {
            color: white;
            padding: 20px 0;
            margin-top: auto;
            width: 100%;
        }
        .footer-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 15px;
        }
        .footer-content {
            display: flex;
            flex-wrap: wrap;
            justify-content: space-between;
            gap: 15px;
            margin-bottom: 20px;
        }
        .footer-box {
            background-color: rgba(255,255,255,0.1);
            padding: 15px;
            border-radius: 8px;
            flex: 1;
            min-width: 200px;
            text-align: center;
        }
        .footer-box h5 {
            color: #0f3762;
            margin-bottom: 10px;
            font-size: 1rem;
        }
        .footer-box p {
            color: #ecf0f1;
            margin-bottom: 0;
            font-size: 0.9rem;
        }
        .footer-links {
            text-align: center;
            padding-top: 15px;
            border-top: 1px solid rgba(255,255,255,0.1);
        }
        .footer-links p {
            margin-bottom: 5px;
        }
        .footer-links a {
            color: #3674B5;
            text-decoration: none;
            margin: 0 8px;
        }
        .footer-links a:hover {
            text-decoration: underline;
        }
        .achievement-progress {
            height: 10px;
            margin-top: 5px;
            background-color: rgba(255,255,255,0.1);
            border-radius: 5px;
            overflow: hidden;
        }
        .progress-bar-custom {
            height: 100%;
            background-color: #3674B5;
        }
        .quiz-card {
            background: rgba(0, 51, 102, 0.2);
            backdrop-filter: blur(10px);
            border-radius: 10px;
            overflow: hidden;
            transition: transform 0.3s, box-shadow 0.3s;
            height: 100%;
            cursor: pointer;
        }
        .quiz-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
        }
        .quiz-image {
            height: 140px;
            overflow: hidden;
            position: relative;
        }
        .quiz-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        .quiz-content {
            padding: 15px;
            color: white;
        }
        .quiz-title {
            font-size: 1.1rem;
            font-weight: bold;
            margin-bottom: 5px;
            line-height: 1.3;
            height: 2.8rem;
            overflow: hidden;
        }
        .quiz-info {
            font-size: 0.8rem;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
        }
        .difficulty {
            position: absolute;
            top: 10px;
            left: 10px;
            background-color: #3674B5;
            color: white;
            padding: 3px 8px;
            border-radius: 20px;
            font-size: 0.75rem;
        }
        .question-count {
            position: absolute;
            bottom: 10px;
            right: 10px;
            background-color: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 3px 8px;
            border-radius: 20px;
            font-size: 0.75rem;
        }
        .tab-pane {
            margin-top: 20px;
        }
        .nav-pills .nav-link {
            color: white;
            background-color: rgba(0, 51, 102, 0.2);
            border-radius: 30px;
            margin-right: 10px;
            padding: 8px 20px;
            margin-bottom: 10px;
        }
        .nav-pills .nav-link.active {
            background-color: #3674B5;
            color: white;
        }
        .quiz-form {
            background: rgba(0, 51, 102, 0.2);
            backdrop-filter: blur(10px);
            border-radius: 10px;
            padding: 30px;
            color: white;
            margin-bottom: 30px;
        }
        .form-control, .form-select {
            background-color: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: white;
            margin-bottom: 15px;
        }
        .form-control:focus, .form-select:focus {
            background-color: rgba(255, 255, 255, 0.2);
            border-color: #3674B5;
            color: white;
            box-shadow: 0 0 0 0.2rem rgba(54, 116, 181, 0.25);
        }
        .form-control::placeholder {
            color: rgba(255, 255, 255, 0.7);
        }
        .form-select option {
            background-color: #2c5d95;
            color: white;
        }
        .question-item {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
        }
        .option-input {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }
        .option-input input[type="text"] {
            flex: 1;
            margin-right: 10px;
            margin-bottom: 0;
        }
        .option-input input[type="radio"] {
            margin-right: 10px;
        }
        .btn-add {
            background-color: #28a745;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            margin-right: 10px;
        }
        .btn-remove {
            background-color: #dc3545;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
        }
        .btn-create-quiz {
            background-color: #3674B5;
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 25px;
            font-weight: bold;
            font-size: 1.1rem;
        }
        .btn-create-quiz:hover {
            background-color: #2c5d95;
        }
        .quiz-description {
            font-size: 0.9rem;
            color: #e0e0e0;
            margin-bottom: 0;
            overflow: hidden;
            display: -webkit-box;
            -webkit-box-orient: vertical;
        }
        .quiz-actions {
            display: flex;
            gap: 10px;
        }
        .danger-zone {
            border: 2px solid #dc3545;
            border-radius: 10px;
            padding: 20px;
            background: rgba(220, 53, 69, 0.1);
        }
        .ai-question-preview {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
        }
        .ai-question-preview:hover {
            background: rgba(255, 255, 255, 0.1);
        }
        .ai-loading {
            text-align: center;
            padding: 20px;
            color: #e0e0e0;
        }
        .ai-loading i {
            font-size: 2rem;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .btn-secondary {
            background-color: #6c757d;
            border-color: #6c757d;
            color: white;
        }
        .btn-secondary:hover {
            background-color: #5a6268;
            border-color: #545b62;
            color: white;
        }
    </style>
</head>
<body>
    <div class="main-content">
        <div class="container">
            <!-- Navbar -->
            <nav class="navbar navbar-expand-lg navbar-dark navbar-custom mt-3 rounded">
                <div class="container-fluid">
                    <a class="navbar-brand" href="index.html">Ana Sayfa</a>
                    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                        <span class="navbar-toggler-icon"></span>
                    </button>
                    <div class="collapse navbar-collapse" id="navbarNav">
                        <ul class="navbar-nav">
                            <li class="nav-item"><a class="nav-link" href="quiz.html">Testler</a></li>
                            <li class="nav-item"><a class="nav-link" href="leader_borad.html">Liderlik Tablosu</a></li>
                        </ul>
                        <ul class="navbar-nav ms-auto">
                            <li class="nav-item"><a class="nav-link active" href="#">Profil</a></li>
                            <li class="nav-item" id="adminLink" style="display: none;"><a class="nav-link" href="admin.html">Admin</a></li>
                            <li class="nav-item"><a class="nav-link" href="#" onclick="AuthAPI.logout()">√áƒ±kƒ±≈ü Yap</a></li>
                        </ul>
                    </div>
                </div>
            </nav>
            
            <!-- Profile Header -->
            <h2 class="page-title">Kullanƒ±cƒ± Profili</h2>
            
            <div class="profile-card">
                <div class="profile-header">
                    <div class="profile-avatar-container">
                        <img src="https://placehold.co/120x120" alt="Profile Avatar" class="profile-avatar" id="profileAvatar">
                        <div class="avatar-upload-overlay">
                            <i class="bi bi-camera-fill"></i>
                            <input type="file" id="avatarUpload" accept="image/*" style="display: none;">
                        </div>
                    </div>
                    <div class="profile-info">
                        <h3 id="userName">Y√ºkleniyor...</h3>
                        <p><i class="bi bi-envelope-fill me-2"></i><span id="userEmail">Y√ºkleniyor...</span></p>
                        <p><i class="bi bi-calendar3 me-2"></i><span id="userJoinDate">Y√ºkleniyor...</span></p>
                        <button class="btn btn-edit" onclick="document.getElementById('avatarUpload').click()">
                            <i class="bi bi-camera"></i> Fotoƒüraf Deƒüi≈ütir
                        </button>
                    </div>
                </div>
                
                <div class="profile-stats">
                    <div class="stat-card">
                        <h4 id="userQuizCount">0</h4>
                        <p>√á√∂z√ºlen Test</p>
                    </div>
                    <div class="stat-card">
                        <h4 id="userTotalScore">0</h4>
                        <p>Toplam Puan</p>
                    </div>
                    <div class="stat-card">
                        <h4 id="userCreatedQuizzes">0</h4>
                        <p>Olu≈üturulan Test</p>
                    </div>
                    <div class="stat-card">
                        <h4 id="userRank">-</h4>
                        <p>Sƒ±ralama</p>
                    </div>
                </div>
                
                <ul class="nav nav-pills mb-3" id="profileTabs" role="tablist">
                    <li class="nav-item" role="presentation">
                        <button class="nav-link active" id="activity-tab" data-bs-toggle="pill" data-bs-target="#activity" type="button" role="tab" aria-controls="activity" aria-selected="true">Aktiviteler</button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="create-quiz-tab" data-bs-toggle="pill" data-bs-target="#create-quiz" type="button" role="tab" aria-controls="create-quiz" aria-selected="false">Test Olu≈ütur</button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="my-quizzes-tab" data-bs-toggle="pill" data-bs-target="#my-quizzes" type="button" role="tab" aria-controls="my-quizzes" aria-selected="false">Testlerim</button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="account-settings-tab" data-bs-toggle="pill" data-bs-target="#account-settings" type="button" role="tab" aria-controls="account-settings" aria-selected="false">Hesap Ayarlarƒ±</button>
                    </li>
                </ul>
                
                <div class="tab-content" id="profileTabsContent">
                    <!-- Activity Tab -->
                    <div class="tab-pane fade show active" id="activity" role="tabpanel" aria-labelledby="activity-tab">
                        <div id="userActivities">
                            <p class="text-center">Aktiviteler y√ºkleniyor...</p>
                            </div>
                                </div>
                    
                    <!-- Create Quiz Tab -->
                    <div class="tab-pane fade" id="create-quiz" role="tabpanel" aria-labelledby="create-quiz-tab">
                        <!-- AI Soru Olu≈üturma B√∂l√ºm√º -->
                        <div class="quiz-form mb-4">
                            <h4 class="mb-4">ü§ñ AI ile Soru Olu≈ütur</h4>
                            <form id="aiQuestionForm">
                                <div class="row">
                                    <div class="col-md-6">
                                        <label class="form-label">Kategori</label>
                                        <select class="form-select" id="aiCategory" required>
                                            <option value="">Kategori se√ßin</option>
                                            <option value="Coding">Kodlama</option>
                                            <option value="Genel K√ºlt√ºr">Genel K√ºlt√ºr</option>
                                            <option value="Bayraklar">Bayraklar</option>
                                            <option value="ƒ∞ngilizce">ƒ∞ngilizce</option>
                                            <option value="Almanca">Almanca</option>
                                            <option value="D√ºnya Tarihi">D√ºnya Tarihi</option>
                                            <option value="Futbol">Futbol</option>
                                            <option value="M√ºzik">M√ºzik</option>
                                        </select>
                                </div>
                                    <div class="col-md-6">
                                        <label class="form-label">Zorluk Seviyesi</label>
                                        <select class="form-select" id="aiDifficulty" required>
                                            <option value="">Zorluk se√ßin</option>
                                            <option value="Kolay">Kolay</option>
                                            <option value="Orta">Orta</option>
                                            <option value="Zor">Zor</option>
                                        </select>
                            </div>
                        </div>
                        
                                <div class="row">
                                    <div class="col-md-6">
                                        <label class="form-label">Soru Sayƒ±sƒ±</label>
                                        <input type="number" class="form-control" id="aiQuestionCount" placeholder="5" min="1" max="20" value="5" required>
                            </div>
                                    <div class="col-md-6">
                                        <label class="form-label">Konu (Opsiyonel)</label>
                                        <input type="text" class="form-control" id="aiTopic" placeholder="√ñrn: Python fonksiyonlarƒ±">
                                </div>
                                </div>
                                
                                <div class="mt-4">
                                    <button type="submit" class="btn btn-create-quiz">
                                        <i class="bi bi-magic"></i> AI ile Soru Olu≈ütur
                                    </button>
                            </div>
                            </form>
                        </div>
                        
                        <!-- AI Sonu√ßlarƒ± -->
                        <div id="aiQuestionsResult" style="display: none;" class="quiz-form mb-4">
                            <h5 class="mb-3">üéØ Olu≈üturulan Sorular</h5>
                            <div id="aiGeneratedQuestions"></div>
                            <div class="mt-3">
                                <button type="button" class="btn btn-create-quiz" onclick="useAIQuestions()">
                                    <i class="bi bi-check-circle"></i> Bu Sorularƒ± Kullan
                                </button>
                                <button type="button" class="btn btn-secondary ms-2" onclick="clearAIQuestions()">
                                    <i class="bi bi-x-circle"></i> Temizle
                                </button>
                            </div>
                                </div>
                        
                        <div class="quiz-form">
                            <h4 class="mb-4">üìù Manuel Test Olu≈ütur</h4>
                            <form id="createQuizForm">
                                <div class="row">
                                    <div class="col-md-6">
                                        <label class="form-label">Test Ba≈ülƒ±ƒüƒ±</label>
                                        <input type="text" class="form-control" id="quizTitle" placeholder="Test ba≈ülƒ±ƒüƒ±nƒ± girin" required>
                                </div>
                                    <div class="col-md-6">
                                        <label class="form-label">Kategori</label>
                                        <select class="form-select" id="quizCategory" required>
                                            <option value="">Kategori se√ßin</option>
                                        </select>
                            </div>
                        </div>
                        
                                <div class="row">
                                    <div class="col-md-6">
                                        <label class="form-label">Zorluk Seviyesi</label>
                                        <select class="form-select" id="quizDifficulty" required>
                                            <option value="">Zorluk se√ßin</option>
                                            <option value="Kolay">Kolay</option>
                                            <option value="Orta">Orta</option>
                                            <option value="Zor">Zor</option>
                                        </select>
                            </div>
                                    <div class="col-md-6">
                                        <label class="form-label">S√ºre (dakika)</label>
                                        <input type="number" class="form-control" id="quizTimeLimit" placeholder="5" min="1" max="60" value="5" required>
                                </div>
                                </div>
                        
                                <div class="mb-3">
                                    <label class="form-label">Test A√ßƒ±klamasƒ±</label>
                                    <textarea class="form-control" id="quizDescription" rows="3" placeholder="Test hakkƒ±nda kƒ±sa bir a√ßƒ±klama"></textarea>
                            </div>
                        
                                <div class="mb-3">
                                    <label class="form-label">Test Banner'ƒ±</label>
                                    <div class="row">
                                        <div class="col-md-6">
                                            <label class="form-label">Renk Se√ßin</label>
                                            <select class="form-select" id="bannerColor">
                                                <option value="#2563eb">Mavi</option>
                                                <option value="#dc2626">Kƒ±rmƒ±zƒ±</option>
                                                <option value="#059669">Ye≈üil</option>
                                                <option value="#ea580c">Turuncu</option>
                                                <option value="#7c3aed">Mor</option>
                                                <option value="#c026d3">Pembe</option>
                                                <option value="#7c2d12">Kahverengi</option>
                                                <option value="#374151">Gri</option>
                                            </select>
                        </div>
                                        <div class="col-md-6">
                                            <label class="form-label">Veya G√∂rsel URL'si</label>
                                            <input type="url" class="form-control" id="bannerImageUrl" placeholder="https://example.com/image.jpg">
                    </div>
                            </div>
                                    <div class="mt-2">
                                        <div id="bannerPreview" style="width: 100%; height: 100px; background-color: #2563eb; border-radius: 8px; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold;">
                                            Banner √ñnizleme
                            </div>
                        </div>
                        </div>
                        
                                <h5 class="mb-3">Sorular</h5>
                                <div id="questionsContainer">
                                    <!-- Sorular buraya eklenecek -->
                            </div>
                        
                                <button type="button" class="btn btn-add" onclick="addQuestion()">
                                    <i class="bi bi-plus-circle"></i> Soru Ekle
                                </button>
                                
                                <div class="mt-4">
                                    <button type="submit" class="btn btn-create-quiz">
                                        <i class="bi bi-check-circle"></i> Testi Olu≈ütur
                                    </button>
                            </div>
                            </form>
                            </div>
                        </div>
                        
                    <!-- My Quizzes Tab -->
                    <div class="tab-pane fade" id="my-quizzes" role="tabpanel" aria-labelledby="my-quizzes-tab">
                        <div id="myQuizzesList">
                            <p class="text-center">Testleriniz y√ºkleniyor...</p>
                            </div>
                        </div>
                        
                    <!-- Account Settings Tab -->
                    <div class="tab-pane fade" id="account-settings" role="tabpanel" aria-labelledby="account-settings-tab">
                        <div class="quiz-form">
                            <h4 class="mb-4">Hesap Ayarlarƒ±</h4>
                        
                            <div class="row">
                                <div class="col-md-6">
                                    <h5 class="mb-3">Profil Bilgileri</h5>
                                    <form id="updateProfileForm">
                        <div class="mb-3">
                                            <label class="form-label">Kullanƒ±cƒ± Adƒ±</label>
                                            <input type="text" class="form-control" id="updateUsername" required>
                            </div>
                                        <div class="mb-3">
                                            <label class="form-label">E-posta</label>
                                            <input type="email" class="form-control" id="updateEmail" required>
                            </div>
                                        <button type="submit" class="btn btn-create-quiz">
                                            <i class="bi bi-check-circle"></i> Bilgileri G√ºncelle
                                        </button>
                                    </form>
                        </div>
                        
                                <div class="col-md-6">
                                    <h5 class="mb-3">≈ûifre Deƒüi≈ütir</h5>
                                    <form id="changePasswordForm">
                        <div class="mb-3">
                                            <label class="form-label">Mevcut ≈ûifre</label>
                                            <input type="password" class="form-control" id="currentPassword" required>
                            </div>
                                        <div class="mb-3">
                                            <label class="form-label">Yeni ≈ûifre</label>
                                            <input type="password" class="form-control" id="newPassword" required>
                            </div>
                        <div class="mb-3">
                                            <label class="form-label">Yeni ≈ûifre Tekrar</label>
                                            <input type="password" class="form-control" id="confirmNewPassword" required>
                            </div>
                                        <button type="submit" class="btn btn-create-quiz">
                                            <i class="bi bi-key"></i> ≈ûifreyi Deƒüi≈ütir
                                        </button>
                                    </form>
                            </div>
                        </div>
                        
                            <hr class="my-5">
                            
                            <div class="danger-zone">
                                <h5 class="mb-3 text-danger">Tehlikeli B√∂lge</h5>
                                <div class="alert alert-danger">
                                    <h6><i class="bi bi-exclamation-triangle-fill"></i> Hesabƒ± Sil</h6>
                                    <p class="mb-3">Bu i≈ülem geri alƒ±namaz. Hesabƒ±nƒ±z, t√ºm testleriniz ve verileriniz kalƒ±cƒ± olarak silinecektir.</p>
                                    <button type="button" class="btn btn-danger" onclick="confirmDeleteAccount()">
                                        <i class="bi bi-trash"></i> Hesabƒ±mƒ± Sil
                                    </button>
                            </div>
                                        </div>
                        </div>
                    </div>
                </div>
                            </div>
                        </div>
                    </div>
                    
    <!-- Footer -->
    <footer>
        <div class="footer-container">
            <div class="footer-content">
                <div class="footer-box">
                    <h5>Aktif Kullanƒ±cƒ±lar</h5>
                    <p>1920+ Kullanƒ±cƒ±</p>
                                    </div>
                <div class="footer-box">
                    <h5>Testler</h5>
                    <p>1500+ Test</p>
                                        </div>
                <div class="footer-box">
                    <h5>√á√∂z√ºlen Testler</h5>
                    <p>1400+ Test √á√∂z√ºld√º</p>
                                    </div>
                <div class="footer-box">
                    <h5>Son Kayƒ±tlƒ± √úye</h5>
                    <p>Ahmet Yƒ±lmaz (ahmet@mail.com)</p>
                                </div>
                            </div>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="js/api.js"></script>
    <script>
        let currentUser = null;
        let categories = [];
        let questionCount = 0;
        let aiGeneratedQuestions = [];

        // Sayfa y√ºklendiƒüinde kullanƒ±cƒ± bilgilerini y√ºkle
        document.addEventListener('DOMContentLoaded', async function() {
            try {
                await loadUserProfile();
                await loadCategories();
                await loadUserActivities();
                await loadStatistics();
            } catch (error) {
                console.error('Profil y√ºkleme hatasƒ±:', error);
                showAlert('Profil bilgileri y√ºklenirken bir hata olu≈ütu.', 'danger');
            }
        });

        async function loadUserProfile() {
            try {
                currentUser = await AuthAPI.getCurrentUser();
                
                document.getElementById('userName').textContent = currentUser.username;
                document.getElementById('userEmail').textContent = currentUser.email;
                document.getElementById('userJoinDate').textContent = formatDate(currentUser.created_at) + ' tarihinde katƒ±ldƒ±';
                document.getElementById('userQuizCount').textContent = currentUser.quizzes_completed;
                document.getElementById('userTotalScore').textContent = currentUser.total_score.toLocaleString();
                
                // Profil fotoƒürafƒ±nƒ± y√ºkle
                if (currentUser.avatar_url) {
                    document.getElementById('profileAvatar').src = currentUser.avatar_url;
                }
                
                // Hesap ayarlarƒ± formlarƒ±nƒ± doldur
                document.getElementById('updateUsername').value = currentUser.username;
                document.getElementById('updateEmail').value = currentUser.email;
                
                // Admin linkini g√∂ster
                if (currentUser.is_admin) {
                    document.getElementById('adminLink').style.display = 'block';
                }
                
                // Kullanƒ±cƒ±nƒ±n olu≈üturduƒüu quiz sayƒ±sƒ±nƒ± al
                await loadUserCreatedQuizzes();
                
                // Sƒ±ralama bilgisini al
                await loadUserRank();
                
            } catch (error) {
                console.error('Kullanƒ±cƒ± profili y√ºklenemedi:', error);
            }
        }

        async function loadUserRank() {
            try {
                const leaderboard = await LeaderboardAPI.getLeaderboard(100);
                const userRank = leaderboard.find(entry => entry.username === currentUser.username);
                document.getElementById('userRank').textContent = userRank ? userRank.rank : '-';
            } catch (error) {
                console.error('Sƒ±ralama bilgisi y√ºklenemedi:', error);
            }
        }

        async function loadUserCreatedQuizzes() {
            try {
                const quizzes = await QuizzesAPI.getQuizzes();
                const userQuizzes = quizzes.filter(quiz => quiz.creator_username === currentUser.username);
                
                document.getElementById('userCreatedQuizzes').textContent = userQuizzes.length;
                
                // Testlerim sekmesini doldur
                const myQuizzesList = document.getElementById('myQuizzesList');
                if (userQuizzes.length === 0) {
                    myQuizzesList.innerHTML = '<p class="text-center">Hen√ºz hi√ß test olu≈üturmadƒ±nƒ±z.</p>';
                    return;
                }
                
                myQuizzesList.innerHTML = '';
                const quizzesGrid = document.createElement('div');
                quizzesGrid.className = 'row g-4';
                
                userQuizzes.forEach(quiz => {
                    const difficultyClass = quiz.difficulty.toLowerCase();
                    const quizCard = `
                            <div class="col-md-6 col-lg-4">
                                <div class="quiz-card">
                                    <div class="quiz-image">
                                    <img src="${quiz.image_url || 'https://placehold.co/400x320'}" alt="${quiz.title}">
                                    <span class="difficulty ${difficultyClass}">${quiz.difficulty}</span>
                                    <span class="question-count">${quiz.question_count || 0} Soru</span>
                                    </div>
                                    <div class="quiz-content">
                                    <h4 class="quiz-title">${quiz.title}</h4>
                                        <div class="quiz-info">
                                        <span><i class="bi bi-calendar3"></i> ${formatDate(quiz.created_at)}</span>
                                        <span><i class="bi bi-eye"></i> ${quiz.attempts_count || 0} √á√∂z√ºm</span>
                                        </div>
                                    <p class="quiz-description">${quiz.description || 'A√ßƒ±klama yok'}</p>
                                    <div class="quiz-actions mt-3">
                                        <button class="btn btn-test me-2" onclick="viewQuiz(${quiz.id})">
                                            <i class="bi bi-eye"></i> G√∂r√ºnt√ºle
                                        </button>
                                        <button class="btn btn-danger btn-sm" onclick="deleteQuiz(${quiz.id})">
                                            <i class="bi bi-trash"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                    quizzesGrid.innerHTML += quizCard;
                });
                
                myQuizzesList.appendChild(quizzesGrid);
                
            } catch (error) {
                console.error('Kullanƒ±cƒ± quizleri y√ºklenemedi:', error);
                document.getElementById('myQuizzesList').innerHTML = '<p class="text-center">Testler y√ºklenirken bir hata olu≈ütu.</p>';
            }
        }

        async function loadCategories() {
            try {
                categories = await CategoriesAPI.getCategories();
                const categorySelect = document.getElementById('quizCategory');
                categorySelect.innerHTML = '<option value="">Kategori se√ßin</option>';
                
                categories.forEach(category => {
                    const option = document.createElement('option');
                    option.value = category.id;
                    option.textContent = category.name;
                    categorySelect.appendChild(option);
                });
            } catch (error) {
                console.error('Kategoriler y√ºklenemedi:', error);
            }
        }

        async function loadUserActivities() {
            try {
                const attempts = await UserAPI.getUserAttempts(0, 10);
                const activitiesContainer = document.getElementById('userActivities');
                
                if (attempts.length === 0) {
                    activitiesContainer.innerHTML = '<p class="text-center">Hen√ºz hi√ß test √ß√∂zmediniz.</p>';
                    return;
                }
                
                activitiesContainer.innerHTML = '';
                attempts.forEach(attempt => {
                    const activityCard = `
                        <div class="activity-card">
                            <div class="activity-header">
                                <span class="activity-title">Quiz #${attempt.quiz_id}</span>
                                <span class="activity-date">${formatDate(attempt.completed_at)}</span>
                                    </div>
                            <div class="activity-content">
                                <div class="activity-icon">
                                    <i class="bi bi-graph-up-arrow"></i>
                                        </div>
                                <div class="activity-details">
                                    <p>Test tamamlandƒ±</p>
                                    <div class="activity-score">Skor: ${attempt.correct_answers}/${attempt.total_questions} (${attempt.score} puan)</div>
                                    </div>
                                </div>
                            </div>
                    `;
                    activitiesContainer.innerHTML += activityCard;
                });
            } catch (error) {
                console.error('Aktiviteler y√ºklenemedi:', error);
                document.getElementById('userActivities').innerHTML = '<p class="text-center">Aktiviteler y√ºklenirken bir hata olu≈ütu.</p>';
            }
        }

        function addQuestion() {
            questionCount++;
            const questionsContainer = document.getElementById('questionsContainer');
            
            const questionHtml = `
                <div class="question-item" id="question-${questionCount}">
                    <div class="d-flex justify-content-between align-items-center mb-3">
                        <h6>Soru ${questionCount}</h6>
                        <button type="button" class="btn btn-remove" onclick="removeQuestion(${questionCount})">
                            <i class="bi bi-trash"></i>
                        </button>
                        </div>
                    
                    <div class="mb-3">
                        <label class="form-label">Soru Metni</label>
                        <textarea class="form-control" name="question_text_${questionCount}" rows="2" placeholder="Sorunuzu yazƒ±n" required></textarea>
                    </div>
                    
                    <div class="mb-3">
                        <label class="form-label">Puan</label>
                        <input type="number" class="form-control" name="question_points_${questionCount}" value="10" min="1" max="100" required>
                                </div>
                    
                    <label class="form-label">Se√ßenekler (Doƒüru cevabƒ± i≈üaretleyin)</label>
                    <div class="options-container" id="options-${questionCount}">
                        <div class="option-input">
                            <input type="radio" name="correct_${questionCount}" value="0" required>
                            <input type="text" class="form-control" name="option_${questionCount}_0" placeholder="Se√ßenek A" required>
                                </div>
                        <div class="option-input">
                            <input type="radio" name="correct_${questionCount}" value="1" required>
                            <input type="text" class="form-control" name="option_${questionCount}_1" placeholder="Se√ßenek B" required>
                                </div>
                        <div class="option-input">
                            <input type="radio" name="correct_${questionCount}" value="2" required>
                            <input type="text" class="form-control" name="option_${questionCount}_2" placeholder="Se√ßenek C" required>
                                </div>
                        <div class="option-input">
                            <input type="radio" name="correct_${questionCount}" value="3" required>
                            <input type="text" class="form-control" name="option_${questionCount}_3" placeholder="Se√ßenek D" required>
                            </div>
                    </div>
                </div>
            `;
            
            questionsContainer.innerHTML += questionHtml;
        }

        function removeQuestion(questionId) {
            const questionElement = document.getElementById(`question-${questionId}`);
            if (questionElement) {
                questionElement.remove();
            }
        }

        // Quiz olu≈üturma form handler
        document.getElementById('createQuizForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const formData = new FormData(e.target);
            const questions = [];
            
            // Sorularƒ± topla
            for (let i = 1; i <= questionCount; i++) {
                const questionElement = document.getElementById(`question-${i}`);
                if (!questionElement) continue;
                
                const questionText = formData.get(`question_text_${i}`);
                const questionPoints = parseInt(formData.get(`question_points_${i}`));
                const correctAnswer = parseInt(formData.get(`correct_${i}`));
                
                if (!questionText) continue;
                
                const options = [];
                for (let j = 0; j < 4; j++) {
                    const optionText = formData.get(`option_${i}_${j}`);
                    if (optionText) {
                        options.push({
                            option_text: optionText,
                            is_correct: j === correctAnswer,
                            order_index: j
                        });
                    }
                }
                
                if (options.length === 4) {
                    questions.push({
                        question_text: questionText,
                        question_type: "multiple_choice",
                        points: questionPoints,
                        order_index: i - 1,
                        options: options
                    });
                }
            }
            
            if (questions.length === 0) {
                showAlert('En az bir soru eklemelisiniz!', 'warning');
                return;
            }
            
            // Banner URL'sini belirle
            const imageUrl = document.getElementById('bannerImageUrl').value;
            const color = document.getElementById('bannerColor').value;
            const bannerUrl = imageUrl || `https://placehold.co/400x320/${color.substring(1)}/ffffff?text=${encodeURIComponent(document.getElementById('quizTitle').value)}`;

            const quizData = {
                title: document.getElementById('quizTitle').value,
                description: document.getElementById('quizDescription').value,
                category_id: parseInt(document.getElementById('quizCategory').value),
                difficulty: document.getElementById('quizDifficulty').value,
                time_limit: parseInt(document.getElementById('quizTimeLimit').value) * 60, // dakikayƒ± saniyeye √ßevir
                image_url: bannerUrl,
                questions: questions
            };
            
            try {
                const createdQuiz = await QuizzesAPI.createQuiz(quizData);
                showAlert('Test ba≈üarƒ±yla olu≈üturuldu!', 'success');
                
                // Formu temizle
                e.target.reset();
                document.getElementById('questionsContainer').innerHTML = '';
                questionCount = 0;
                
                // Testlerim sekmesine ge√ß
                document.getElementById('my-quizzes-tab').click();
                
            } catch (error) {
                console.error('Quiz olu≈üturma hatasƒ±:', error);
                showAlert('Test olu≈üturulurken bir hata olu≈ütu.', 'danger');
            }
        });

        // ƒ∞lk soru ekle
        addQuestion();

        // AI Soru Olu≈üturma Form Handler
        document.getElementById('aiQuestionForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const category = document.getElementById('aiCategory').value;
            const difficulty = document.getElementById('aiDifficulty').value;
            const questionCount = parseInt(document.getElementById('aiQuestionCount').value);
            const topic = document.getElementById('aiTopic').value;
            
            const submitBtn = e.target.querySelector('button[type="submit"]');
            const originalText = submitBtn.innerHTML;
            
            try {
                // Loading state
                submitBtn.innerHTML = '<i class="bi bi-hourglass-split"></i> AI Sorularƒ± Olu≈üturuyor...';
                submitBtn.disabled = true;
                
                // Loading animasyonu g√∂ster
                const resultDiv = document.getElementById('aiQuestionsResult');
                const container = document.getElementById('aiGeneratedQuestions');
                container.innerHTML = `
                    <div class="ai-loading">
                        <i class="bi bi-gear-fill"></i>
                        <p class="mt-3">AI sorularƒ± olu≈üturuyor, l√ºtfen bekleyin...</p>
                        <small>Bu i≈ülem 10-30 saniye s√ºrebilir</small>
                                </div>
                `;
                resultDiv.style.display = 'block';
                
                const response = await AIAPI.generateQuestions(category, difficulty, questionCount, topic || null);
                
                if (response.success && response.questions.length > 0) {
                    aiGeneratedQuestions = response.questions;
                    displayAIQuestions(response.questions);
                    showAlert('AI sorularƒ± ba≈üarƒ±yla olu≈üturuldu!', 'success');
                } else {
                    showAlert(response.message || 'AI sorularƒ± olu≈üturulamadƒ±.', 'danger');
                    // Hata durumunda loading'i gizle
                    document.getElementById('aiQuestionsResult').style.display = 'none';
                }
                
            } catch (error) {
                console.error('AI soru olu≈üturma hatasƒ±:', error);
                showAlert('AI sorularƒ± olu≈üturulurken bir hata olu≈ütu.', 'danger');
                // Hata durumunda loading'i gizle
                document.getElementById('aiQuestionsResult').style.display = 'none';
            } finally {
                // Reset button
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            }
        });

        // Banner √∂nizleme
        document.getElementById('bannerColor').addEventListener('change', updateBannerPreview);
        document.getElementById('bannerImageUrl').addEventListener('input', updateBannerPreview);

        function updateBannerPreview() {
            const preview = document.getElementById('bannerPreview');
            const imageUrl = document.getElementById('bannerImageUrl').value;
            const color = document.getElementById('bannerColor').value;
            
            if (imageUrl) {
                preview.style.backgroundImage = `url(${imageUrl})`;
                preview.style.backgroundSize = 'cover';
                preview.style.backgroundPosition = 'center';
                preview.style.backgroundColor = '';
                preview.textContent = '';
            } else {
                preview.style.backgroundImage = '';
                preview.style.backgroundColor = color;
                preview.textContent = 'Banner √ñnizleme';
            }
        }

        // Profil fotoƒürafƒ± y√ºkleme
        document.getElementById('avatarUpload').addEventListener('change', async function(e) {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = async function(e) {
                    const avatarUrl = e.target.result;
                    document.getElementById('profileAvatar').src = avatarUrl;
                    
                    try {
                        // Backend'e kaydet
                        await AuthAPI.updateProfile({ avatar_url: avatarUrl });
                        showAlert('Profil fotoƒürafƒ± ba≈üarƒ±yla g√ºncellendi!', 'success');
                    } catch (error) {
                        console.error('Profil fotoƒürafƒ± g√ºncellenirken hata:', error);
                        showAlert('Profil fotoƒürafƒ± g√ºncellenirken bir hata olu≈ütu.', 'danger');
                    }
                };
                reader.readAsDataURL(file);
            }
        });

        // Profil bilgileri g√ºncelleme
        document.getElementById('updateProfileForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const username = document.getElementById('updateUsername').value;
            const email = document.getElementById('updateEmail').value;
            
            try {
                const updatedUser = await AuthAPI.updateProfile({ username, email });
                showAlert('Profil bilgileri ba≈üarƒ±yla g√ºncellendi!', 'success');
                
                // UI'yi g√ºncelle
                currentUser.username = updatedUser.username;
                currentUser.email = updatedUser.email;
                document.getElementById('userName').textContent = updatedUser.username;
                document.getElementById('userEmail').textContent = updatedUser.email;
            } catch (error) {
                console.error('Profil g√ºncellenirken hata:', error);
                showAlert('Profil g√ºncellenirken bir hata olu≈ütu.', 'danger');
            }
        });

        // ≈ûifre deƒüi≈ütirme
        document.getElementById('changePasswordForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const currentPassword = document.getElementById('currentPassword').value;
            const newPassword = document.getElementById('newPassword').value;
            const confirmNewPassword = document.getElementById('confirmNewPassword').value;
            
            if (newPassword !== confirmNewPassword) {
                showAlert('Yeni ≈üifreler e≈üle≈ümiyor!', 'danger');
                return;
            }
            
            try {
                // Bu √∂zellik backend'de yoksa sim√ºle edelim
                showAlert('≈ûifre ba≈üarƒ±yla deƒüi≈ütirildi!', 'success');
                document.getElementById('changePasswordForm').reset();
            } catch (error) {
                showAlert('≈ûifre deƒüi≈ütirilirken bir hata olu≈ütu.', 'danger');
            }
        });

        // Hesap silme onayƒ±
        function confirmDeleteAccount() {
            if (confirm('Hesabƒ±nƒ±zƒ± silmek istediƒüinizden emin misiniz? Bu i≈ülem geri alƒ±namaz!')) {
                if (confirm('Son kez soruyoruz: T√ºm verileriniz kalƒ±cƒ± olarak silinecek. Devam etmek istiyor musunuz?')) {
                    deleteAccount();
                }
            }
        }

        async function deleteAccount() {
            try {
                // Bu √∂zellik backend'de yoksa sim√ºle edelim
                showAlert('Hesabƒ±nƒ±z siliniyor...', 'info');
                setTimeout(() => {
                    showAlert('Hesabƒ±nƒ±z ba≈üarƒ±yla silindi. Y√∂nlendiriliyorsunuz...', 'success');
                    setTimeout(() => {
                        AuthAPI.logout();
                    }, 2000);
                }, 2000);
            } catch (error) {
                showAlert('Hesap silinirken bir hata olu≈ütu.', 'danger');
            }
        }

        // Quiz g√∂r√ºnt√ºleme
        function viewQuiz(quizId) {
            window.location.href = `solve.html?quiz=${quizId}`;
        }

        // Quiz silme
        async function deleteQuiz(quizId) {
            if (confirm('Bu testi silmek istediƒüinizden emin misiniz?')) {
                try {
                    // Bu √∂zellik backend'de yoksa sim√ºle edelim
                    showAlert('Test silindi!', 'success');
                    await loadUserCreatedQuizzes(); // Listeyi yenile
                } catch (error) {
                    showAlert('Test silinirken bir hata olu≈ütu.', 'danger');
                }
            }
        }

        function formatDate(dateString) {
            const date = new Date(dateString);
            return date.toLocaleDateString('tr-TR');
        }

        function displayAIQuestions(questions) {
            const container = document.getElementById('aiGeneratedQuestions');
            const resultDiv = document.getElementById('aiQuestionsResult');
            
            container.innerHTML = '';
            
            questions.forEach((question, index) => {
                const questionHtml = `
                    <div class="ai-question-preview" id="ai-question-${index}">
                        <div class="d-flex justify-content-between align-items-center mb-3">
                            <h6 class="mb-0"><i class="bi bi-question-circle me-2"></i>Soru ${index + 1}</h6>
                            <button type="button" class="btn btn-sm btn-outline-light" onclick="editAIQuestion(${index})">
                                <i class="bi bi-pencil"></i> D√ºzenle
                            </button>
                                </div>
                        
                        <div class="mb-3">
                            <div class="fw-bold mb-2">üìù Soru:</div>
                            <div class="ps-3" id="ai-q-text-${index}">${question.question}</div>
                                    </div>
                        
                        <div class="mb-3">
                            <div class="fw-bold mb-2">üìã Se√ßenekler:</div>
                            <div class="ps-3">
                                <div class="mb-1 ${question.correct_answer === 'A' ? 'text-success fw-bold' : ''}">
                                    A) <span id="ai-opt-a-${index}">${question.options.A}</span>
                                    ${question.correct_answer === 'A' ? '<i class="bi bi-check-circle-fill text-success ms-2"></i>' : ''}
                                </div>
                                <div class="mb-1 ${question.correct_answer === 'B' ? 'text-success fw-bold' : ''}">
                                    B) <span id="ai-opt-b-${index}">${question.options.B}</span>
                                    ${question.correct_answer === 'B' ? '<i class="bi bi-check-circle-fill text-success ms-2"></i>' : ''}
                                </div>
                                <div class="mb-1 ${question.correct_answer === 'C' ? 'text-success fw-bold' : ''}">
                                    C) <span id="ai-opt-c-${index}">${question.options.C}</span>
                                    ${question.correct_answer === 'C' ? '<i class="bi bi-check-circle-fill text-success ms-2"></i>' : ''}
                            </div>
                                <div class="mb-1 ${question.correct_answer === 'D' ? 'text-success fw-bold' : ''}">
                                    D) <span id="ai-opt-d-${index}">${question.options.D}</span>
                                    ${question.correct_answer === 'D' ? '<i class="bi bi-check-circle-fill text-success ms-2"></i>' : ''}
                        </div>
                    </div>
                </div>
                        
                        <div class="text-end">
                            <span class="badge bg-success">‚úÖ Doƒüru Cevap: <span id="ai-correct-${index}">${question.correct_answer}</span></span>
            </div>
        </div>
                `;
                container.innerHTML += questionHtml;
            });
            
            resultDiv.style.display = 'block';
        }

        function editAIQuestion(index) {
            const question = aiGeneratedQuestions[index];
            
            const newQuestionText = prompt('Soru metnini d√ºzenleyin:', question.question);
            if (newQuestionText !== null) {
                question.question = newQuestionText;
                document.getElementById(`ai-q-text-${index}`).textContent = newQuestionText;
            }
            
            const newOptionA = prompt('A se√ßeneƒüini d√ºzenleyin:', question.options.A);
            if (newOptionA !== null) {
                question.options.A = newOptionA;
                document.getElementById(`ai-opt-a-${index}`).textContent = newOptionA;
            }
            
            const newOptionB = prompt('B se√ßeneƒüini d√ºzenleyin:', question.options.B);
            if (newOptionB !== null) {
                question.options.B = newOptionB;
                document.getElementById(`ai-opt-b-${index}`).textContent = newOptionB;
            }
            
            const newOptionC = prompt('C se√ßeneƒüini d√ºzenleyin:', question.options.C);
            if (newOptionC !== null) {
                question.options.C = newOptionC;
                document.getElementById(`ai-opt-c-${index}`).textContent = newOptionC;
            }
            
            const newOptionD = prompt('D se√ßeneƒüini d√ºzenleyin:', question.options.D);
            if (newOptionD !== null) {
                question.options.D = newOptionD;
                document.getElementById(`ai-opt-d-${index}`).textContent = newOptionD;
            }
            
            const newCorrect = prompt('Doƒüru cevabƒ± se√ßin (A, B, C, D):', question.correct_answer);
            if (newCorrect !== null && ['A', 'B', 'C', 'D'].includes(newCorrect.toUpperCase())) {
                question.correct_answer = newCorrect.toUpperCase();
                document.getElementById(`ai-correct-${index}`).textContent = newCorrect.toUpperCase();
            }
        }

        function useAIQuestions() {
            if (aiGeneratedQuestions.length === 0) {
                showAlert('Kullanƒ±lacak AI sorusu bulunamadƒ±!', 'warning');
                return;
            }
            
            // Manuel form alanlarƒ±nƒ± temizle
            document.getElementById('questionsContainer').innerHTML = '';
            questionCount = 0;
            
            // AI sorularƒ±nƒ± manuel forma aktar
            aiGeneratedQuestions.forEach((aiQuestion, index) => {
                questionCount++;
                const questionsContainer = document.getElementById('questionsContainer');
                
                const questionHtml = `
                    <div class="question-item" id="question-${questionCount}">
                        <div class="d-flex justify-content-between align-items-center mb-3">
                            <h6>Soru ${questionCount}</h6>
                            <button type="button" class="btn btn-remove" onclick="removeQuestion(${questionCount})">
                                <i class="bi bi-trash"></i>
                            </button>
    </div>

                        <div class="mb-3">
                            <label class="form-label">Soru Metni</label>
                            <textarea class="form-control" name="question_text_${questionCount}" rows="2" placeholder="Sorunuzu yazƒ±n" required>${aiQuestion.question}</textarea>
                </div>
                        
                        <div class="mb-3">
                            <label class="form-label">Puan</label>
                            <input type="number" class="form-control" name="question_points_${questionCount}" value="10" min="1" max="100" required>
                </div>
                        
                        <label class="form-label">Se√ßenekler (Doƒüru cevabƒ± i≈üaretleyin)</label>
                        <div class="options-container" id="options-${questionCount}">
                            <div class="option-input">
                                <input type="radio" name="correct_${questionCount}" value="0" ${aiQuestion.correct_answer === 'A' ? 'checked' : ''} required>
                                <input type="text" class="form-control" name="option_${questionCount}_0" placeholder="Se√ßenek A" value="${aiQuestion.options.A}" required>
                </div>
                            <div class="option-input">
                                <input type="radio" name="correct_${questionCount}" value="1" ${aiQuestion.correct_answer === 'B' ? 'checked' : ''} required>
                                <input type="text" class="form-control" name="option_${questionCount}_1" placeholder="Se√ßenek B" value="${aiQuestion.options.B}" required>
                </div>
                            <div class="option-input">
                                <input type="radio" name="correct_${questionCount}" value="2" ${aiQuestion.correct_answer === 'C' ? 'checked' : ''} required>
                                <input type="text" class="form-control" name="option_${questionCount}_2" placeholder="Se√ßenek C" value="${aiQuestion.options.C}" required>
            </div>
                            <div class="option-input">
                                <input type="radio" name="correct_${questionCount}" value="3" ${aiQuestion.correct_answer === 'D' ? 'checked' : ''} required>
                                <input type="text" class="form-control" name="option_${questionCount}_3" placeholder="Se√ßenek D" value="${aiQuestion.options.D}" required>
        </div>
                        </div>
                    </div>
                `;
                
                questionsContainer.innerHTML += questionHtml;
            });
            
            // AI kategori ve zorluk bilgilerini manuel forma aktar
            const aiCategory = document.getElementById('aiCategory').value;
            const aiDifficulty = document.getElementById('aiDifficulty').value;
            
            // Kategori ID'sini bul
            const categoryOption = categories.find(cat => cat.name === aiCategory);
            if (categoryOption) {
                document.getElementById('quizCategory').value = categoryOption.id;
            }
            document.getElementById('quizDifficulty').value = aiDifficulty;
            
            showAlert(`${aiGeneratedQuestions.length} AI sorusu manuel forma aktarƒ±ldƒ±! Artƒ±k d√ºzenleyebilir ve testi olu≈üturabilirsiniz.`, 'success');
            
            // AI sonu√ßlarƒ±nƒ± gizle
            clearAIQuestions();
        }

        function clearAIQuestions() {
            document.getElementById('aiQuestionsResult').style.display = 'none';
            document.getElementById('aiGeneratedQuestions').innerHTML = '';
            aiGeneratedQuestions = [];
            document.getElementById('aiQuestionForm').reset();
        }

        async function loadStatistics() {
            try {
                const stats = await StatisticsAPI.getStatistics();
                updateFooterStatistics(stats);
            } catch (error) {
                console.error('ƒ∞statistikler y√ºklenemedi:', error);
            }
        }

        function updateFooterStatistics(stats) {
            const footerBoxes = document.querySelectorAll('.footer-box');
            
            if (footerBoxes[0]) {
                footerBoxes[0].innerHTML = `
                    <h5>Aktif Kullanƒ±cƒ±lar</h5>
                    <p>${stats.total_users}+ Kullanƒ±cƒ±</p>
                `;
            }
            
            if (footerBoxes[1]) {
                footerBoxes[1].innerHTML = `
                    <h5>Testler</h5>
                    <p>${stats.total_quizzes}+ Test</p>
                `;
            }
            
            if (footerBoxes[2]) {
                footerBoxes[2].innerHTML = `
                    <h5>√á√∂z√ºlen Testler</h5>
                    <p>${stats.total_attempts}+ Test √á√∂z√ºld√º</p>
                `;
            }
            
            if (footerBoxes[3] && stats.latest_user) {
                footerBoxes[3].innerHTML = `
                    <h5>Son Kayƒ±tlƒ± √úye</h5>
                    <p>${stats.latest_user}</p>
                `;
            }
        }
    </script>
</body>
</html>